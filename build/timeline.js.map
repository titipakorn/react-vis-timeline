{"version":3,"sources":["../src/timeline.tsx"],"names":["noop","events","eventDefaultProps","event","Timeline","props","React","createRef","Object","defineProperty","value","DataSet","writable","timeline","destroy","VisTimelineCtor","current","items","groups","options","eventHandler","on","init","nextProps","initialItems","initialGroups","selection","customTimes","currentTime","itemsChange","groupsChange","optionsChange","customTimesChange","selectionChange","currentTimeChange","console","warn","setOptions","updateCustomTimes","updateSelection","selectionOptions","setCurrentTime","prevCustomTimes","customTimeKeysPrev","customTimeKeysNew","customTimeKeysToAdd","customTimeKeysToRemove","customTimeKeysToUpdate","id","removeCustomTime","datetime","addCustomTime","setCustomTime","setSelection","animate","timelineOptions","setWindow","start","end","animation","length","add","Component"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { DataSet } from 'vis-data/esnext';\nimport { Timeline as VisTimelineCtor } from 'vis-timeline/esnext';\nimport type {\n\tDateType,\n\tIdType,\n\tTimeline as VisTimeline,\n\tTimelineAnimationOptions,\n\tTimelineGroup,\n\tTimelineItem,\n\tTimelineOptions\n} from 'vis-timeline/types';\nimport 'vis-timeline/styles/vis-timeline-graph2d.min.css';\n\nimport _difference from 'lodash/difference';\nimport _intersection from 'lodash/intersection';\nimport _each from 'lodash/each';\nimport _assign from 'lodash/assign';\nimport _omit from 'lodash/omit';\nimport _keys from 'lodash/keys';\nimport type { CustomTime, SelectionOptions, TimelineEventsHandlers, TimelineEventsWithMissing } from './models';\n\nconst noop = function () {};\n\nconst events: TimelineEventsWithMissing[] = [\n\t'currentTimeTick',\n\t'click',\n\t'contextmenu',\n\t'doubleClick',\n\t'dragover',\n\t'drop',\n\t'mouseOver',\n\t'mouseDown',\n\t'mouseUp',\n\t'mouseMove',\n\t'groupDragged',\n\t'changed',\n\t'rangechange',\n\t'rangechanged',\n\t'select',\n\t'itemover',\n\t'itemout',\n\t'timechange',\n\t'timechanged',\n\t'markerchange',\n\t'markerchanged'\n];\n\nconst eventDefaultProps: TimelineEventsHandlers = {};\n_each(events, event => {\n\teventDefaultProps[`${event}Handler`] = noop;\n});\n\ntype Props = {\n\tinitialItems?: TimelineItem[];\n\tinitialGroups?: TimelineGroup[];\n\toptions?: TimelineOptions;\n\tselection?: IdType[];\n\tcustomTimes?: CustomTime[];\n\tselectionOptions?: SelectionOptions;\n\tanimate?: boolean | {};\n\tcurrentTime?: DateType;\n} & TimelineEventsHandlers;\n\nexport class Timeline extends Component<Props, {}> {\n\tstatic defaultProps = _assign(\n\t\t{\n\t\t\tinitialItems: [],\n\t\t\tgroups: [],\n\t\t\toptions: {},\n\t\t\tselection: [],\n\t\t\tcustomTimes: []\n\t\t},\n\t\teventDefaultProps\n\t);\n\n\tpublic timeline: Readonly<VisTimeline>;\n\tpublic readonly items: DataSet<TimelineItem>;\n\tpublic readonly groups: DataSet<TimelineGroup>;\n\n\t#ref = React.createRef<HTMLDivElement>();\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\n\t\tObject.defineProperty(this, 'items', {\n\t\t\tvalue: new DataSet<TimelineItem>(),\n\t\t\twritable: false\n\t\t});\n\n\t\tObject.defineProperty(this, 'groups', {\n\t\t\tvalue: new DataSet<TimelineGroup>(),\n\t\t\twritable: false\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.timeline.destroy();\n\t}\n\n\tcomponentDidMount() {\n\t\tObject.defineProperty(this, 'timeline', {\n\t\t\tvalue: new VisTimelineCtor(this.#ref.current, this.items, this.groups, this.props.options),\n\t\t\twritable: false\n\t\t});\n\n\t\tfor (const event of events) {\n\t\t\tconst eventHandler = this.props[`${event}Handler`];\n\t\t\tif (eventHandler !== noop) {\n\t\t\t\tthis.timeline.on(event, eventHandler);\n\t\t\t}\n\t\t}\n\n\t\tthis.init();\n\t}\n\n\tshouldComponentUpdate(nextProps: Props) {\n\t\tconst { initialItems, initialGroups, options, selection, customTimes, currentTime } = this.props;\n\n\t\tconst itemsChange = initialItems !== nextProps.initialItems;\n\t\tconst groupsChange = initialGroups !== nextProps.initialGroups;\n\t\tconst optionsChange = options !== nextProps.options;\n\t\tconst customTimesChange = customTimes !== nextProps.customTimes;\n\t\tconst selectionChange = selection !== nextProps.selection;\n\t\tconst currentTimeChange = currentTime !== nextProps.currentTime;\n\n\t\tif (groupsChange) {\n\t\t\tconsole.warn(\n\t\t\t\t\"react-vis-timeline: you are trying to change 'initialGroups' prop. Please use the public api exposed with in ref\"\n\t\t\t);\n\t\t}\n\n\t\tif (itemsChange) {\n\t\t\tconsole.warn(\n\t\t\t\t\"react-vis-timeline: you are trying to change 'initialItems' prop. Please use the public api exposed with in ref\"\n\t\t\t);\n\t\t}\n\n\t\tif (optionsChange) {\n\t\t\tthis.timeline.setOptions(nextProps.options);\n\t\t}\n\n\t\tif (customTimesChange) {\n\t\t\tthis.updateCustomTimes(customTimes, nextProps.customTimes);\n\t\t}\n\n\t\tif (selectionChange) {\n\t\t\tthis.updateSelection(nextProps.selection, nextProps.selectionOptions);\n\t\t}\n\n\t\tif (currentTimeChange) {\n\t\t\tthis.timeline.setCurrentTime(nextProps.currentTime);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tupdateCustomTimes(prevCustomTimes: CustomTime[], customTimes: CustomTime[]) {\n\t\t// diff the custom times to decipher new, removing, updating\n\t\tconst customTimeKeysPrev = _keys(prevCustomTimes);\n\t\tconst customTimeKeysNew = _keys(customTimes);\n\t\tconst customTimeKeysToAdd = _difference(customTimeKeysNew, customTimeKeysPrev);\n\t\tconst customTimeKeysToRemove = _difference(customTimeKeysPrev, customTimeKeysNew);\n\t\tconst customTimeKeysToUpdate = _intersection(customTimeKeysPrev, customTimeKeysNew);\n\n\t\t_each(customTimeKeysToRemove, id => this.timeline.removeCustomTime(id));\n\t\t_each(customTimeKeysToAdd, id => {\n\t\t\tconst datetime = customTimes[id].datetime;\n\t\t\tthis.timeline.addCustomTime(datetime, id);\n\t\t});\n\t\t_each(customTimeKeysToUpdate, id => {\n\t\t\tconst datetime = customTimes[id].datetime;\n\t\t\tthis.timeline.setCustomTime(datetime, id);\n\t\t});\n\t}\n\n\tupdateSelection(selection: IdType | IdType[], selectionOptions: SelectionOptions): void {\n\t\tthis.timeline.setSelection(selection, selectionOptions as Required<SelectionOptions>);\n\t}\n\n\tinit() {\n\t\tconst {\n\t\t\tinitialItems,\n\t\t\tinitialGroups,\n\t\t\toptions,\n\t\t\tselection,\n\t\t\tselectionOptions = {},\n\t\t\tcustomTimes,\n\t\t\tanimate = true,\n\t\t\tcurrentTime\n\t\t} = this.props;\n\n\t\tlet timelineOptions = options;\n\n\t\tif (animate) {\n\t\t\t// If animate option is set, we should animate the timeline to any new\n\t\t\t// start/end values instead of jumping straight to them\n\t\t\ttimelineOptions = _omit(options, 'start', 'end');\n\n\t\t\tthis.timeline.setWindow(options.start, options.end, {\n\t\t\t\tanimation: animate\n\t\t\t} as TimelineAnimationOptions);\n\t\t}\n\n\t\tthis.timeline.setOptions(timelineOptions);\n\n\t\tif (initialGroups?.length > 0) {\n\t\t\tthis.groups.add(initialGroups);\n\t\t}\n\n\t\tif (initialItems?.length > 0) {\n\t\t\tthis.items.add(initialItems);\n\t\t}\n\n\t\tthis.updateSelection(selection, selectionOptions);\n\n\t\tif (currentTime) {\n\t\t\tthis.timeline.setCurrentTime(currentTime);\n\t\t}\n\n\t\tthis.updateCustomTimes([], customTimes);\n\t}\n\n\trender() {\n\t\treturn <div ref={this.#ref} />;\n\t}\n}\n"],"file":"timeline.js"}